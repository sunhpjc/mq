### 1.规则引擎
code和type共同决定是否配置了规则
发送的时候走路由

因素：appcode（应用是否可用）,router（是否配置路由）,type（短信类型）

注意：方案一：通道关闭之前应检测是否有路由在使用，通道类型变更之前应检测是否有路由在使用

注意：方案二：路由之前检测通道是否可用。。。。此方案每次发送之前都要去检测一次，存在性能缺陷

### 2.改进
sms表新增冗余字段type

规则流程查看图片

发送之前按照appcode，type把查出来的list进行分组，再查询路由状态，可以减少部分数据库访问量
1. appcode可用
    1. 配置路由
        1. 路由状态可用
            1. 从路由配置的通道发送（完成之后，更新状态以及发送通道）
        2. 路由状态不可用（关闭或者删除）
            1. 按照type查找其它费率最低的通道发送（完成之后，更新状态以及发送通道）
    2. 未配置路由
        1. 按照type查找其它费率最低的通道发送（完成之后，更新状态以及发送通道）
    
2. appcode不可用
    1. 定义失败
    
### 3.备注
1. 写了部分GateWay测试代码在里面
2. webflux测试代码(待完善)